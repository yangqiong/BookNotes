以太网协议规定，同一局域网的一台主机和另一台主机进行直接通信，必须知道目标地址的MAC地址。数据链路层的以太网协议接到上层IP协议的数据中，只包含目的主机的IP地址。于是需要根据IP地址，获取其MAC地址。[【维基百科】](https://zh.wikipedia.org/wiki/地址解析协议)

ARP，地址解析协议就是在发送帧前将目标IP地址转化为MAC地址的过程。

## ARP协议

* 硬件类型：2字节，1 - MAC地址
* 协议类型：2字节， 0x800 - IP地址
* 硬件地址长度：1字节，当为MAC地址时，值为6
* 协议地址长度：1字节，当为IPv4时，值为4
* 操作：2字节， ARP请求（值为1），ARP响应（值为2）
* 发送端以太网地址：6字节
* 发送端IP地址：4字节
* 目的地以太网地址：6字节
* 目的地IP地址：4字节

ARP请求或者响应报文共28字节

1. 当发送数据时，主机A会现在自己的ARP缓冲表中寻找是否有目标IP地址，如果找到就知道目标的MAC地址，直接把目标MAC地址写入帧发送。
2. 如果ARP缓冲表中没有目标IP地址，主机A在网络中发送一个广播，目标MAC地址为“FF:FF:FF:FF:FF:FF”。
3. 网络中其他的主机不会响应，只有目标主机的IP，与ARP请求中目标IP一致的主机才会响应，响应中包含自己的MAC地址。主机收到ARP响应后就可以想目标主机发送信息，并更新自己的ARP缓冲表。



